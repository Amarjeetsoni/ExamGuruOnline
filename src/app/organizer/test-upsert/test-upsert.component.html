<h3 style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;color: #3498db; text-align: center;"><u>TEST HANDLER</u></h3>
<hr>
<div class="form-steps">
    <ul class="row steps">
        <li class="gap" ></li>
        <li *ngIf="currentStep <= 1">
            <div class="step-box">
              <i class="fas fa-circle" *ngIf="currentStep != 1"></i>
              <i class="fa fa-map-signs" *ngIf="currentStep == 1" style="color: yellowgreen;font-size: 40px;"></i>
              <span style="font-weight: bold;">Instruction</span>
            </div>
          </li>
          <li *ngIf="currentStep > 1">
            <div class="step-box">
              <i class="fas fa-check-circle"></i>
              <span style="color: rgb(250, 0, 0);">Instruction</span>
            </div>
          </li>
          <li class="gap"></li>
          <li class="gap"></li>
          <li class="gapnew"></li>
          <li *ngIf="currentStep <= 2">
            <div class="step-box">
              <i class="fas fa-circle" *ngIf="currentStep != 2"></i>
              <i class="fa fa-map-signs" *ngIf="currentStep == 2" style="color: yellowgreen;font-size: 40px;"></i>
              <span style="font-weight: bold;" *ngIf="currentStep == 2">Basic Details</span>
              <span *ngIf="currentStep != 2">Basic Details</span>
            </div>
          </li>
          <li *ngIf="currentStep > 2">
            <div class="step-box">
              <i class="fas fa-check-circle"></i>
              <span style="color: rgb(250, 0, 0);">Basic Details</span>
            </div>
          </li>
          <li class="gap" ></li>
          <li class="gap"></li>
          <li class="gapnew" ></li>
          <li *ngIf="currentStep <= 3">
            <div class="step-box">
              <i class="fa fa-map-signs" *ngIf="currentStep == 3" style="color: yellowgreen;font-size: 40px;"></i>
              <i class="fas fa-circle" *ngIf="currentStep != 3"></i>
              <span *ngIf="currentStep != 3">Select Question</span>
              <span style="font-weight: bold;" *ngIf="currentStep == 3">Select Question</span>
            </div>
          </li>
          <li *ngIf="currentStep > 3">
            <div class="step-box">
              <i class="fas fa-check-circle"></i>
              <span style="color: rgb(250, 0, 0);">Select Question</span>
            </div>
          </li>
          <li class="gap" ></li>
          <li class="gap"></li>
          <li class="gapnew"></li>

          <li *ngIf="currentStep <= 4">
            <div class="step-box">
              <i class="fa fa-map-signs" *ngIf="currentStep == 4" style="color: yellowgreen;font-size: 40px;"></i>
              <i class="fas fa-circle" *ngIf="currentStep != 4"></i>
              <span *ngIf="currentStep != 4">Review</span>
              <span style="font-weight: bold;" *ngIf="currentStep == 4">Review</span>
            </div>
          </li>
          <li *ngIf="currentStep > 4">
            <div class="step-box">
              <i class="fas fa-check-circle"></i>
              <span style="color: rgb(250, 0, 0);">Review</span>
            </div>
          </li>
          <li class="gap"></li>
          <li class="gap"></li>
          <li class="gapnew"></li>

          <li *ngIf="currentStep <= 5">
            <div class="step-box">
              <i class="fa fa-map-signs" *ngIf="currentStep == 5" style="color: yellowgreen;font-size: 40px;"></i>
              <i class="fas fa-circle" *ngIf="currentStep != 5"></i>
              <span *ngIf="currentStep != 5">Finish</span>
              <span style="font-weight: bold;" *ngIf="currentStep == 5">Finish</span>
            </div>
          </li>
          <li *ngIf="currentStep > 5">
            <div class="step-box">
              <i class="fas fa-check-circle"></i>
              <span style="color: rgb(250, 0, 0);">Finish</span>
            </div>
          </li>
      </ul>
      <hr>
    <div *ngIf="currentStep == 1" class="bodyStyle">
        <h3><u><b>Instruction</b></u>&nbsp;<i class="fas fa-info-circle"></i></h3>
        <br>
  <p>Please read the following instructions carefully before proceeding to add new Test Details:</p>
  <ol>
    <li>
      First, add all questions you require for the test by clicking on the <strong>Upsert Question</strong> button from the side menu.
    </li>
    <br>
    <li>
      In case you need to add a new question while adding a question, do not click on the Upsert Question button. Instead, click on the <strong>Add New Question</strong> button shown on that screen itself. It will redirect you to a new page.
    </li>
    <br>
    <li>
      After adding a new question from the new tab, refresh the question list by clicking on the <strong>Refresh</strong> button on the same tab and proceed to add questions.
    </li>
    <br>
    <li>
      Do not navigate away from or refresh the tab during the addition of questions, else all the details may be lost.
    </li>
    <br>
  </ol>
  <input type="checkbox" style="height: 1.3vw;width: 1.3vw;" id="proceedCheckbox" (click)="proceedClicked()">&nbsp;&nbsp;&nbsp;
  <label for="proceedCheckbox" ><u style = "color: blue;">I have read and understood the instructions. Proceed to the next step.</u></label>
    </div>
    <div *ngIf="currentStep == 2" class="bodyStyle">
      <h3><u><b>Basic Details</b></u>&nbsp;<i class="fas fa-address-card"></i></h3>
      <br>
      <p>To begin creating your test, please provide the following basic details:</p>
      <br>
      <b>Enter Test Name:</b> 
      <div class="row col-6">
        <input type="text" name="testName" id="testName" class="form-control" [(ngModel)]="testName">
      </div>
      <b>Enter Test Category:</b> 
      <div class="row">
        <div class="col-6">
          <select id="testCategory" name="testCategory" class="form-control" [(ngModel)]="testCategory">
            <option value="" disabled selected>Select an Question Category</option>
            <option *ngFor="let cat of allQuestionCategory" [value]="cat['categoryId']">{{ cat['categoryDesc'] }}</option>
          </select>
        </div>
        <div class="col-5">
          <button type="button" class="btn btn-link" (click)="addNewQuestionCategoryName()">RegisterNewOne?</button>
        </div>
      </div>
      <b>Enter Number Of Question:</b> 
      <div class="row col-6">
      <input type="number" name="numQuestion" id="numQuestion" class="form-control" [(ngModel)]="numQuestion">
    </div>
    <b>Enter Total Duration (in minutes):</b> 
      <div class="row col-6">
      <input type="number" name="duration" id="duration" class="form-control" [(ngModel)]="duration">
    </div> 
    <b> Is Test Active : </b>
    <div>
          <input type="checkbox" name="isActive" id="isActive" style="height: 2vw;width: 2vw;" [(ngModel)]="isActive">
    </div>
    <br>
      <p style="color: red; font-size: small;">*Enter All the details to proceed!!</p>
    </div>
    <div *ngIf="currentStep == 3">
      <h3><u><b>Select Questions</b></u>&nbsp;<i class="fas fa-list-alt"></i></h3>
      <br>
      <p class="bodyStyle">Choose a total of <b>{{numQuestion}}</b> questions using checkboxes. To arrange question details by their respective fields, simply click on the field name. To add a new question, click on "Add New Question" on the same page and after adding click on refress button. For further question details, click on the "View" button.</p>
      <br>
      <div class="row">
        <div class="col-3">
          <i style = "color: blue;">Questions to be Selected </i>: <b style="color: red;font-size: large;">{{numQuestion}} </b>
        </div>
        <div class="col-4">
          <i style = "color: blue;">Questions Selected Currently</i>: <b style="color: red;font-size: large;">{{totalSelectedQuestions}} </b>
        </div>
        <div class="col-3">
          <button type="button" class="btn btn-outline-warning" (click)="redirectToNewQuestion()"><i class = "fa fa-plus-square"></i> Add Question</button>
        </div>
        <div class="col-2">
          <button class="btn btn-outline-primary" type="button" (click)="refreshQuestion()">Refresh <i class="fas fa-sync"></i></button>
        </div>

      </div>
      <div class="container mt-4" style="height: 400px; overflow: auto;">
        <table class="table table-striped">
          <!-- Table headers -->
          <thead>
            <tr>
              <th>Select</th>
              <th>Question</th>
              <th>
                <select id="filterCategory" name="filterCategory" class="form-control" [(ngModel)]="filterCategory">
                  <option value="" selected>All Category</option>
                  <option *ngFor="let cat of allQuestionCategory" [value]="cat['categoryDesc']">{{ cat['categoryDesc'] }}</option>
                </select>
              </th>
              <th>Created By User</th>
              <th>Actions</th>
            </tr>
          </thead>
          <!-- Table body -->
          <tbody *ngIf="filteredQuestions.length !== 0">
            <ng-container *ngFor="let question of filteredQuestions">
            <tr *ngIf="!filterCategory || question.categoryDesc === filterCategory || question.categoryDesc === ''">
              <!-- Display question details -->
              <td><input type="checkbox" (change)="checkBoxClicked(question, $event)" style="width: 30px;height: 30px;" [checked]="question.isChecked"></td>
              <td>{{ question.question }}</td>
              <td>{{ question.categoryDesc }}</td>
              <td>{{ question.createdByUser }}</td>
              <td>
                <button class="btn btn-info" (click)="viewDetails(question)" [disabled]="isPopupOpen || viewQuestion">View</button>
              </td>
            </tr>
          </ng-container>
          </tbody>
        </table>
        <div *ngIf="filteredQuestions.length === 0" class="alert alert-info">No questions details found.</div>
      </div>
      <div class="popup" *ngIf="viewQuestion">
        <div class="popup-content">
          <button class="btn btn-link close-button" (click)="CloseViewQuestion()"><i class="fa fa-close"></i></button>
          <h4 style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;color: #3498db; text-align: center;"><u>View Question Details</u></h4>
          <div class="bg-white">
            <div class="col-md-12 col-sm-12 col-lg-12">
              <form>
                  <div class="p-3 py-5">
                      <div class="row mt-3">
                            <textarea class="form-control" value={{selectedQuestion.question}} disabled></textarea>
                      </div>
                      <div class="row mt-3">
                          <div class="row-5">
                            <label class="labels">Category : </label> &nbsp;&nbsp;&nbsp;
                          </div>
                          <div class= "row-6">
                           <input type="text" class="form-control" value={{selectedQuestion.categoryDesc}} disabled>
                          </div>
                      </div>
                      <div class="row mt-3">
                        <div>
                            <div *ngFor="let option of selectedQuestion.questionOption; let i = index" class="row mt-3">
                                <div class="col-5">
                                    <i>Option {{i+1}}: </i>
                                </div>
                                <div class="col-7">
                                    <textarea class="form-control" value={{option}} disabled></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                      <div class="row mt-3">
                        <div class="row-5">
                          <label class="labels">Org Name : </label> &nbsp;&nbsp;&nbsp;
                        </div>
                        <div class= "row-6">
                          <input type="text" class="form-control" placeholder="Organization Name" value={{organizationName}} disabled>
                      
                        </div>
                      </div>
                      <div class="row mt-3">
                        <div class="row-5">
                          <label class="labels">Added by : </label> &nbsp;&nbsp;&nbsp;
                        </div>
                        <div class= "row-6">
                        <input type="text" class="form-control" placeholder="By User" value={{selectedQuestion.createdByUser}} disabled>
                        </div>
                      </div>
                      <div class="row mt-3">
                        <label class="labels" *ngIf="this.selectedQuestion.isMultipleChoise"><i class = "fa fa-check-square" style="font-size:24px;"></i></label>
                        <label class="labels" *ngIf="!this.selectedQuestion.isMultipleChoise"><i class = "fa fa-square" style="font-size:24px; color: gainsboro;"></i></label>
                         &nbsp;&nbsp;&nbsp;
                        <label class="labels">IsMultiple Choise</label>
                      </div>
                      <div class="row mt-3">
                        <label class="labels">Correct Options</label>&nbsp;&nbsp;&nbsp;
                        <textarea class="form-control" type="text" value={{selectedQuestion.correctOption}} disabled></textarea>
                      </div>
                      <div class="mt-5 text-center"><button class="btn btn-warning profile-button" type="button" (click)="CloseViewQuestion()">Close</button></div>
                  </div>
              </form>
              </div>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="currentStep == 4">
      <h3><u><b>Review</b></u>&nbsp;<i class="fa fa-edit"></i></h3>
      <br>
      <p class="bodyStyle">Please thoroughly review all the details below. If any adjustments are needed, simply click the back button to edit and review them once more.
      </p>
      <hr>
      <table>
        <tr>
          <td style="font-size: x-large;font-family: 'Courier New', Courier, monospace">Test Name :</td>
          <td style="font-size:x-large;padding-left: 40px;font-family: 'Courier New', Courier, monospace"><b style="color: blue;">{{testName}}</b></td>
        </tr>
        <tr>
          <td style="font-size: x-large;font-family: 'Courier New', Courier, monospace">Test Category :</td>
          <td style="font-size:x-large;padding-left: 40px;font-family: 'Courier New', Courier, monospace"><b style="color: blue;">{{questionCategoryDesc}} </b></td>
        </tr>
        <tr>
          <td style="font-size: x-large;font-family: 'Courier New', Courier, monospace">Test Total Question : </td>
          <td style="font-size:x-large;padding-left: 40px;font-family: 'Courier New', Courier, monospace"><b style="color: blue">{{this.listOfQuestionIdsSelected.length}}</b></td>
        </tr>
        <tr>
          <td style="font-size: x-large;font-family: 'Courier New', Courier, monospace">Test Duration(in mins) : </td>
          <td style="font-size:x-large;padding-left: 40px;font-family: 'Courier New', Courier, monospace"><b style="color: blue">{{duration}}</b></td>
        </tr>
        <tr>
          <td style="font-size: x-large;font-family: 'Courier New', Courier, monospace">Is Test Active : </td>
          <td style="font-size:x-large;padding-left: 40px;font-family: 'Courier New', Courier, monospace"><b style="color: blue">{{isActive}}</b></td>
        </tr>
      </table>
      <div class="container mt-4" style="height: 400px; overflow: auto;">
        <table class="table table-striped">
          <!-- Table headers -->
          <thead>
            <tr>
              <th>Question</th>
              <th>
                <select id="filterCategory" name="filterCategory" class="form-control" [(ngModel)]="filterCategory">
                  <option value="" selected>All Category</option>
                  <option *ngFor="let cat of allQuestionCategory" [value]="cat['categoryDesc']">{{ cat['categoryDesc'] }}</option>
                </select>
              </th>
              <th>Created By User</th>
              <th>Actions</th>
            </tr>
          </thead>
          <!-- Table body -->
          <tbody *ngIf="listOfQuestionIdsSelected.length !== 0">
            <ng-container *ngFor="let question of listOfQuestionIdsSelected">
            <tr *ngIf="!filterCategory || question.categoryDesc === filterCategory || question.categoryDesc === ''">
              <!-- Display question details -->
              <td>{{ question.question }}</td>
              <td>{{ question.categoryDesc }}</td>
              <td>{{ question.createdByUser }}</td>
              <td>
                <button class="btn btn-info" (click)="viewDetails(question)" [disabled]="isPopupOpen || viewQuestion">View</button>
              </td>
            </tr>
          </ng-container>
          </tbody>
        </table>
        <div *ngIf="filteredQuestions.length === 0" class="alert alert-info">No questions details found.</div>
      <div class="popup" *ngIf="viewQuestion">
        <div class="popup-content">
          <button class="btn btn-link close-button" (click)="CloseViewQuestion()"><i class="fa fa-close"></i></button>
          <h4 style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;color: #3498db; text-align: center;"><u>View Question Details</u></h4>
          <div class="bg-white">
            <div class="col-md-12 col-sm-12 col-lg-12">
              <form>
                  <div class="p-3 py-5">
                      <div class="row mt-3">
                            <textarea class="form-control" value={{selectedQuestion.question}} disabled></textarea>
                      </div>
                      <div class="row mt-3">
                          <div class="row-5">
                            <label class="labels">Category : </label> &nbsp;&nbsp;&nbsp;
                          </div>
                          <div class= "row-6">
                           <input type="text" class="form-control" value={{selectedQuestion.categoryDesc}} disabled>
                          </div>
                      </div>
                      <div class="row mt-3">
                        <div>
                            <div *ngFor="let option of selectedQuestion.questionOption; let i = index" class="row mt-3">
                                <div class="col-5">
                                    <i>Option {{i+1}}: </i>
                                </div>
                                <div class="col-7">
                                    <textarea class="form-control" value={{option}} disabled></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                      <div class="row mt-3">
                        <div class="row-5">
                          <label class="labels">Org Name : </label> &nbsp;&nbsp;&nbsp;
                        </div>
                        <div class= "row-6">
                          <input type="text" class="form-control" placeholder="Organization Name" value={{organizationName}} disabled>
                      
                        </div>
                      </div>
                      <div class="row mt-3">
                        <div class="row-5">
                          <label class="labels">Added by : </label> &nbsp;&nbsp;&nbsp;
                        </div>
                        <div class= "row-6">
                        <input type="text" class="form-control" placeholder="By User" value={{selectedQuestion.createdByUser}} disabled>
                        </div>
                      </div>
                      <div class="row mt-3">
                        <label class="labels" *ngIf="this.selectedQuestion.isMultipleChoise"><i class = "fa fa-check-square" style="font-size:24px;"></i></label>
                        <label class="labels" *ngIf="!this.selectedQuestion.isMultipleChoise"><i class = "fa fa-square" style="font-size:24px; color: gainsboro;"></i></label>
                         &nbsp;&nbsp;&nbsp;
                        <label class="labels">IsMultiple Choise</label>
                      </div>
                      <div class="row mt-3">
                        <label class="labels">Correct Options</label>&nbsp;&nbsp;&nbsp;
                        <textarea class="form-control" type="text" value={{selectedQuestion.correctOption}} disabled></textarea>
                      </div>
                      <div class="mt-5 text-center"><button class="btn btn-warning profile-button" type="button" (click)="CloseViewQuestion()">Close</button></div>
                  </div>
              </form>
              </div>
          </div>
        </div>
      </div>
    </div>
    </div>
    <div *ngIf="currentStep == 5">
      <div class="message-container endbody">
        <div class="icon">
          ðŸ˜Š
        </div>
        <div>
          <p class="bodyStyle"><b>Wow! You have successfully registered a test with the name:</b></p>
          <br>
          <h2 style="font-family: Arial, sans-serif;"><b><u style = "color: blue;">{{testName}}</u></b></h2>
        </div>
      </div>
    </div>
    <hr>
    <div class="buttons-container" *ngIf="!backNextDisabled">
      <button class="btn btn-dark" (click)="prevStep()" [disabled]="currentStep <= 1 || backNextDisabled">Back</button>&nbsp;&nbsp;&nbsp;&nbsp;
      <button class="btn btn-dark" (click)="nextStep()" [disabled]="currentStep > 5 || isEnabledNext || backNextDisabled">Next</button>
    </div>
    <div class="buttons-container" *ngIf="backNextDisabled">
      <button type="button" class="btn btn-outline-info" (click)="redirectToActivateTest()"><i class = "fa fa-plus-square"></i> Activate Test</button>
    </div>
  </div>
<hr>
  